<?xml version="1.0" encoding="utf-8"?>
<package
  name="modelCovidseir"
  displayName="Add-On to the Epi Package for the Covidseir model"
  isAddOn="True"
  extendsPackage="epi"
  version="1.0.0">
  <transformers>
    <transformer
      name="Fit"
      isPrimary="True"
      displayName="Covidseir Model - Fit"
      programName="Rscript"
      programArguments="fit.R"
      extendsTransformer="epi_Primary"
      isRunnable ="True">
      <include>
        <transformer name="Project"/>
      </include>
    </transformer>
    <transformer
      name="Project"
      displayName="Covidseir Model - Project"
      programName="Rscript"
      programArguments="project.R"
      extendsTransformer="epi_Primary"
      isRunnable ="True">
      <datafeeds>
        <datafeed name="TidyProj" displayName="Fit to Case Data" dataScope="Scenario" isOutput="True">
          <datasheets>
            <datasheet name="TidyProj" displayName="Fit to Case Data">
              <columns>
                <column name="ScenarioID" dataType="Integer"/>
                <column name="Date" dataType="Date" displayName="Date"/>
                <column name="Day" dataType="Integer" displayName="Days elapsed"/>
                <column name="YRepMean" dataType="Double" displayName=""/>
                <column name="YRep05" dataType="Double" displayName=""/>
                <column name="YRep25" dataType="Double" displayName=""/>
                <column name="YRep50" dataType="Double" displayName=""/>
                <column name="YRep75" dataType="Double" displayName=""/>
                <column name="YRep95" dataType="Double" displayName=""/>
                <column name="MuMean" dataType="Double" displayName=""/>
                <column name="Mu05" dataType="Double" displayName=""/>
                <column name="Mu25" dataType="Double" displayName=""/>
                <column name="Mu50" dataType="Double" displayName=""/>
                <column name="Mu75" dataType="Double" displayName=""/>
                <column name="Mu95" dataType="Double" displayName=""/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
      </datafeeds>
    </transformer>
  </transformers>
</package>


<transformer
  name="Project"
  displayName="Covidseir Model - Project"
  programName="Rscript"
  programArguments="project.R"
  extendsTransformer="epi_Primary"
  isRunnable ="True">
  <datafeeds>
    <datafeed name="ProjParams" displayName="Fitting Function Parameters" dataScope="Scenario" isInput="True">
      <datasheets>
        <datasheet name="ProjParams" displayName="Fitting Function Parameters" isSingleRow="True">
          <columns>
            <column name="ScenarioID" dataType="Integer" isPrimary="True" isInput="True"/>
            <column name="DaysProject" dataType="Integer" displayName="Days to Project"/>
            <column name="MinIteration" dataType="Integer" displayName="Minimum Iteration"/>
            <column name="MaxIteration" dataType="Integer" displayName="Maximum Iteration"/>
            <column name="StartChange" dataType="Integer" displayName="Day of social distancing change"/>
            <!-- this number must be one of the columns of the segment table -->
            <column name="Resampling" dataType="Integer" displayName="Number of Samples"/>
            <column name="FSegment" dataType="Integer" displayName="Social distancing segment"/>
            <column name="Parallel" dataType="Integer" displayName="Parallel processing" validationType="List" formula1="1:Yes|0:No"/>
          </columns>
          <defaultRecords>
            <record columns="DaysProject|MinIteration|MaxIteration|StartChange|Resampling|FSegment|Parallel" values="45|1|50|5|30|1|1"/>
          </defaultRecords>
        </datasheet>
      </datasheets>
    </datafeed>
    <datafeed name="TidyProj" displayName="Fit to Case Data" dataScope="Scenario" isOutput="True">
      <datasheets>
        <datasheet name="TidyProj" displayName="Fit to Case Data">
          <columns>
            <column name="ScenarioID" dataType="Integer"/>
            <column name="Date" dataType="Date" displayName="Date"/>
            <column name="Day" dataType="Integer" displayName="Days elapsed"/>
            <column name="YRepMean" dataType="Double" displayName=""/>
            <column name="YRep05" dataType="Double" displayName=""/>
            <column name="YRep25" dataType="Double" displayName=""/>
            <column name="YRep50" dataType="Double" displayName=""/>
            <column name="YRep75" dataType="Double" displayName=""/>
            <column name="YRep95" dataType="Double" displayName=""/>
            <column name="MuMean" dataType="Double" displayName=""/>
            <column name="Mu05" dataType="Double" displayName=""/>
            <column name="Mu25" dataType="Double" displayName=""/>
            <column name="Mu50" dataType="Double" displayName=""/>
            <column name="Mu75" dataType="Double" displayName=""/>
            <column name="Mu95" dataType="Double" displayName=""/>
          </columns>
        </datasheet>
      </datasheets>
    </datafeed>
  </datafeeds>
</transformer>

<datafeed name="DelayDist" displayName="Reporting Delay Distribution Parameters" dataScope="Scenario" isOutput="True">
  <datasheets>
    <datasheet name="DelayDist" displayName="Reporting Delay Distribution Parameters">
      <columns>
        <column name="ScenarioID" dataType="Integer"/>
        <column name="x" dataType="Double" displayName="x"/>
        <column name="y" dataType="Double" displayName="y"/>
      </columns>
    </datasheet>
  </datasheets>
</datafeed>


						<item name="DelayDist"/>

            <include>
              <transformer name="Fit"/>
            </include>

            <datafeed name="DelayFileInfo" displayName="rightTruncation Github" dataScope="Scenario" isOutput="True">
              <datasheets>
                <datasheet name="DelayFileInfo" displayName="rightTruncation Github" isSingleRow="True">
                  <columns>
                    <column name="ScenarioID" displayName="Scenario" dataType="Integer"/>
                  </columns>
                </datasheet>
              </datasheets>
            </datafeed>
